% Suha's Proposal
\documentclass{article}


\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{arydshln}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{color}

\usepackage{amsfonts}
\usepackage{xspace}
\usepackage{latexsym}
\usepackage{wasysym} % causing problems with llncs's bold vectors
\usepackage{stmaryrd}
\usepackage{alltt}
\usepackage{mathpartir}
\usepackage[ligature,reserved,inference]{semantic}
\usepackage[lined]{algorithm2e}
\def\ttat{\mtt{@}} % the at package clobbers this
\usepackage{at}
\usepackage{alltt}


%\usepackage[numbers]{natbib}

%\input macros

\newtheorem{dfn}{Definition}
\newtheorem{lem}{Lemma}

\title{Existence of Forward Simulations for Particular Data Structures}
\begin{document}
\maketitle
\input{prelim}
\input{queue}

\section{Existence of Forward Simulations for Stack Implementations that have Fixed Pop Linearization Points}
\input{commit}
First, describe the TS-Stack algorithm:

\begin{lstlisting}
Type Node{
 elt:Vals;
 ts: int;
 next: Node;
 taken: bool;
};


pools: [Tid]Node; //Keeps top of pools, 
//Initially they point to sentinel dummy nodes s s.t.
//s.next = s and s.ts = -1 and s.taken=false
TSGen: int;    //Timestamp generator initially 0

void push(e:Vals, tid:Tid){
  Node n = new Node(e, MAX_INT, NULL, false);
  n.next = pools[tid];
  pools[tid] = n;
  i: int = TSGen++;
  n.ts = i;
}

Vals pop(){
 success: bool = false;
 maxTS: int = -1;
 youngest: Node = NULL;
 while(!success){
  maxTS: int = -1;
  youngest = NULL;
  for(current in pools){
    n: Node = current;
    while(n.taken && n.next != n)
      n = n.next;
    if(maxTS < n.ts)
      youngest = n;
  }
  success = CAS(youngest.taken,false,true);
 }
 return youngest;
}

\end{lstlisting}
\input{set}
\end{document}
